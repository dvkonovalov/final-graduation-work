Этот модуль реализует обучение и использование моделей для предсказания цен на основе входных признаков.  
Сервер построен на **FastAPI** и предоставляет два основных эндпоинта: `/train` для обучения моделей и `/predict` для предсказания.

---

## Установка

```bash
pip install -r requirements.txt
```

## Структура проекта

```plaintext
.
├── app.py          # Основной файл FastAPI приложения
├── predict.py      # Модуль для предсказания на основе сохранённой модели
├── train.py        # Модуль для обучения моделей
├── models/         # Папка для сохранённых моделей
│   └── модели
└── README.md       # Документация проекта
```

---

## Запуск сервера

```bash
uvicorn app:app --reload
```

Сервер будет доступен по адресу:
```plaintext
http://127.0.0.1:8000
```

---

## Эндпоинты

### `POST /train`

Запускает процесс обучения моделей.

**Пример запроса:**
```bash
curl -X POST http://127.0.0.1:8000/train
```

**Ответ:**
```json
{
  "status": "success",
  "message": "Models trained and saved."
}
```

---

### `POST /predict`

Делает предсказание на основе переданных признаков.

**Формат запроса:**
```json
{
  "features": {
    "feature_1": 0.5,
    "feature_2": 1.2,
    "feature_3": 3.4,
    ...
  }
}
```

**Пример запроса с помощью `curl`:**
```bash
curl -X POST "http://127.0.0.1:8000/predict" \
     -H "Content-Type: application/json" \
     -d "{\"features\": {\"feature1\": 0.5, \"feature2\": 1.2, \"feature3\": 3.4}}"
```

**Ответ:**
```json
{
  "status": "success",
  "prediction": 12345.67
}
```

---

## Как это работает

1. **Обучение (`/train`)**:
   - Запускается обучение моделей, включая LSTM.
   - Модель сохраняется в папку `models/`.

2. **Предсказание (`/predict`)**:
   - Загружается сохранённая модель LSTM.
   - Входные данные (словарь признаков) преобразуются в тензор.
   - Модель делает предсказание на этих данных.

---

## Возможные ошибки

- **Ошибка несовпадения размерностей**: Если структура признаков при обучении и при предсказании отличается.
- **Отсутствие модели**: Убедись, что модель обучена и файл `models/lstm_model.pt` существует перед использованием `/predict`.
- **Формат признаков**: Важно отправлять признаки в формате словаря (`dict`), иначе будет ошибка преобразования.